# Hadoku Trader Worker Configuration
# This is a reference config - copy relevant parts to hadoku-site's wrangler.toml

name = "hadoku-trader"
main = "src/worker.ts"  # Standalone entry for local dev
compatibility_date = "2024-01-01"

# Routes - add to hadoku-site's routes
# routes = [
#   { pattern = "hadoku.me/api/trader/*", zone_name = "hadoku.me" }
# ]

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "trader-db"
database_id = "YOUR_DATABASE_ID"  # Replace after creating with: wrangler d1 create trader-db

# Secrets (set with wrangler secret put)
# - SCRAPER_API_KEY: API key for hadoku-scraper to post signals
# - TRADER_API_KEY: API key for trade execution
# - TUNNEL_URL: URL to local fidelity service via cloudflared
# - SCRAPER_URL: URL to hadoku-scraper API for market data

# Scheduled triggers
[triggers]
crons = [
  "0 */8 * * *",        # Every 8 hours: full sync (signals, market prices, process, performance, budget)
  "*/15 14-21 * * 1-5"  # Every 15min during market hours: monitor positions for exits
]

# Development settings
[dev]
port = 8787
local_protocol = "http"

# For local D1 development
# Run: wrangler d1 execute trader-db --local --file=./schema.sql
